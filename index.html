<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Prüfungstermine BM HSO</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
    --bg:#f5f7fb;
    --card:#ffffff;
    --accent:#2563eb;
    --accent-soft:#dbeafe;
    --text:#111827;
    --muted:#6b7280;
    --border:#e5e7eb;
    --ok:#16a34a;
}

* {
    box-sizing:border-box;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
}

body {
    margin:0;
    background:var(--bg);
    color:var(--text);
}

.container {
    max-width:800px;
    margin:auto;
    padding:24px 16px 40px;
}

header {
    margin-bottom:24px;
}

h1 {
    margin:0 0 6px;
    font-size:1.8rem;
}

.subtitle {
    color:var(--muted);
    font-size:0.95rem;
}

.card {
    background:var(--card);
    border-radius:12px;
    padding:18px;
    margin-bottom:16px;
    box-shadow:0 8px 20px rgba(15,23,42,.08);
}

.card-title {
    margin:0 0 10px;
    font-size:1.15rem;
}

.text {
    margin:0 0 10px;
    font-size:.95rem;
    color:var(--muted);
    line-height:1.5;
}

.btn {
    display:inline-block;
    margin-top:6px;
    padding:10px 18px;
    background:var(--accent);
    color:#fff;
    border-radius:999px;
    text-decoration:none;
    font-size:.9rem;
    cursor:pointer;
    border:none;
    box-shadow:0 6px 14px rgba(37,99,235,.35);
}

.btn:hover {
    box-shadow:0 8px 18px rgba(37,99,235,.45);
}

.copied {
    color:var(--ok);
    font-size:.85rem;
    margin-top:6px;
    display:none;
}

.link-box {
    margin-top:10px;
    padding:10px;
    border:1px solid var(--border);
    border-radius:8px;
    background:#fafafa;
    font-size:.85rem;
    word-break:break-all;
    cursor:text;
}

.hint {
    margin-top:6px;
    font-size:.8rem;
    color:var(--muted);
}

@media (max-width: 600px) {
    h1 { font-size:1.4rem; }
}
</style>
</head>

<body>
<div class="container">

<header>
    <h1>Prüfungstermine BM HSO</h1>
    <p class="subtitle">
        Zentrale Übersicht über alle Prüfungstermine der Klasse.
    </p>
</header>

<!-- KALENDER-LINK KOPIEREN -->
<section class="card">
    <h2 class="card-title">Kalender-Link kopieren</h2>

    <p class="text">
        Der Prüfungskalender kann in jede gängige Kalender-App eingefügt werden
        (Outlook, Apple Kalender, Google Kalender, Handy).
    </p>

    <button class="btn" onclick="copyCalendarLink()">
        Kalender-Link kopieren
    </button>

    <div id="copiedText" class="copied">
        ✅ Link wurde in die Zwischenablage kopiert
    </div>

    <p class="hint">
        Anschliessend in der Kalender-App „Kalender aus URL / Internetkalender abonnieren“ wählen.
    </p>
</section>

<!-- KURZANLEITUNG -->
<section class="card">
    <h2 class="card-title">Kurzanleitung</h2>

    <p class="text">
        <strong>So fügst du den Prüfungskalender hinzu:</strong>
    </p>

    <p class="text">
        1) Klicke auf „Kalender-Link kopieren“. <br>
        2) Öffne deine Kalender-App. <br>
        3) „Kalender aus URL / Internetkalender abonnieren“ wählen. <br>
        4) Link einfügen → fertig.
    </p>

    <p class="text">
        Alternativ kannst du den Link auch manuell kopieren:
    </p>

    <div class="link-box">
https://calendar.google.com/calendar/ical/86f3a3eb765f4c49fc250489d0a1c9230bdb67dfe31d7a3ce306e5fa1a8b4028@group.calendar.google.com/public/basic.ics
    </div>
</section>

<!-- KOMMENDE PRÜFUNGEN (TABELLE) -->
<section class="card">
    <h2 class="card-title">Kommende Prüfungen (Liste)</h2>

    <p class="text">
        Die folgende Tabelle wird automatisch aus dem Kalender erzeugt
        und zeigt alle kommenden Prüfungen.
    </p>

    <div style="border-radius:8px;overflow:hidden;border:1px solid var(--border);background:#f9fafb;">
        <iframe
            src="https://script.google.com/macros/s/AKfycbxd9pX-fPYpQuLvXeKpEaf-45xRBOwJY1q4t41-FToqTKgZcZPHv9GO_ArfyU0j0bO9cA/exec?view=list"
            style="border:0;width:100%;height:260px;"
            loading="lazy">
        </iframe>
    </div>
</section>

<!-- PRÜFUNGS-KONFLIKTE -->
<section class="card">
    <h2 class="card-title">Prüfungs-Konflikte</h2>

    <p class="text">
        Hier werden Tage angezeigt, an denen mehrere Prüfungen eingetragen sind.
        Die Liste wird automatisch aus dem Kalender erzeugt.
    </p>

    <div style="border-radius:8px;overflow:hidden;border:1px solid var(--border);background:#fef2f2;">
        <iframe
            src="https://script.google.com/macros/s/AKfycbxd9pX-fPYpQuLvXeKpEaf-45xRBOwJY1q4t41-FToqTKgZcZPHv9GO_ArfyU0j0bO9cA/exec"
            style="border:0;width:100%;height:140px;"
            loading="lazy">
        </iframe>
    </div>
</section>

<!-- HINWEISE -->
<section class="card">
    <h2 class="card-title">Hinweise</h2>

    <p class="text">
        Änderungen an den Terminen können nur von mir oder von mir
        freigegebenen Personen vorgenommen werden.
    </p>

    <p class="text">
        Bitte überprüft den Kalender regelmässig, insbesondere vor Prüfungswochen.
    </p>
</section>

</div>

<script>
// ICS-Link zum Kopieren
const calendarLink =
"https://calendar.google.com/calendar/ical/86f3a3eb765f4c49fc250489d0a1c9230bdb67dfe31d7a3ce306e5fa1a8b4028@group.calendar.google.com/public/basic.ics";

function copyCalendarLink() {
    navigator.clipboard.writeText(calendarLink).then(() => {
        const msg = document.getElementById("copiedText");
        msg.style.display = "block";
        setTimeout(() => {
            msg.style.display = "none";
        }, 2500);
    }).catch(() => {
        alert("Kopieren nicht möglich. Bitte den Link im Kasten darunter manuell markieren und kopieren.");
    });
}
</script>

</body>
</html>
